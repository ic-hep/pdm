name: Push Testing

on: [push]

jobs:

  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Install dependencies
        run: sudo apt-get install -y python3 python3-venv swig libssl-dev
      - name: Setup virtualenv
        run: |
          python3 -m venv venv
          (. venv/bin/activate && pip install --upgrade pip wheel setuptools)
      - name: Install pdm from push
        run: (. venv/bin/activate && pip install -e .)
      - name: Install Tox and dependencies (for testing)
        run: (. venv/bin/activate && pip install tox)
      - name: Run tox testing
        run: (. venv/bin/activate && tox -e lint test)    

  unit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Install dependencies
        run: sudo apt-get install -y python3 python3-venv swig libssl-dev
      - name: Setup virtualenv
        run: |
          python3 -m venv venv
          (. venv/bin/activate && pip install --upgrade pip wheel setuptools)
      - name: Install pdm from push
        run: (. venv/bin/activate && pip install -e .)
      - name: Install Tox and dependencies (for testing)
        run: (. venv/bin/activate && pip install tox)
      - name: Run tox testing
        run: (. venv/bin/activate && tox -e unit test)

  full:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Install dependencies
        run: sudo apt-get install -y python3 python3-venv swig libssl-dev
      - name: Setup virtualenv
        run: |
          python3 -m venv venv
          (. venv/bin/activate && pip install --upgrade pip wheel setuptools)
      - name: Install pdm from push
        run: (. venv/bin/activate && pip install -e .)
      - name: Install Tox and dependencies (for testing)
        run: (. venv/bin/activate && pip install tox)
      - name: Run tox testing
        run: (. venv/bin/activate && tox -e full test)
